<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>导语：为什么需要自动化部署 | 白 日 淡</title>
    <meta name="description" content="空空而来，又怎能空空而去">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.0d19fd84.css" as="style"><link rel="preload" href="/assets/js/app.07421936.js" as="script"><link rel="preload" href="/assets/js/66.b275255b.js" as="script"><link rel="prefetch" href="/assets/js/10.da7d1ee6.js"><link rel="prefetch" href="/assets/js/11.b2419c0a.js"><link rel="prefetch" href="/assets/js/12.91038659.js"><link rel="prefetch" href="/assets/js/13.16f6d96c.js"><link rel="prefetch" href="/assets/js/14.717547c1.js"><link rel="prefetch" href="/assets/js/15.7024b64f.js"><link rel="prefetch" href="/assets/js/16.e6fd1184.js"><link rel="prefetch" href="/assets/js/17.5ade8dfb.js"><link rel="prefetch" href="/assets/js/18.98b5a4b1.js"><link rel="prefetch" href="/assets/js/19.43aa5948.js"><link rel="prefetch" href="/assets/js/2.9c18cab0.js"><link rel="prefetch" href="/assets/js/20.fffefcad.js"><link rel="prefetch" href="/assets/js/21.aadaff04.js"><link rel="prefetch" href="/assets/js/22.ad8ef7fa.js"><link rel="prefetch" href="/assets/js/23.fc9bc37b.js"><link rel="prefetch" href="/assets/js/24.e3406894.js"><link rel="prefetch" href="/assets/js/25.b5a9fc9b.js"><link rel="prefetch" href="/assets/js/26.1b5eae32.js"><link rel="prefetch" href="/assets/js/27.c85a8cc9.js"><link rel="prefetch" href="/assets/js/28.85b53558.js"><link rel="prefetch" href="/assets/js/29.c96a2c43.js"><link rel="prefetch" href="/assets/js/3.3e457bc3.js"><link rel="prefetch" href="/assets/js/30.a9cf47bf.js"><link rel="prefetch" href="/assets/js/31.35767153.js"><link rel="prefetch" href="/assets/js/32.da2a97a5.js"><link rel="prefetch" href="/assets/js/33.54660318.js"><link rel="prefetch" href="/assets/js/34.c16c6ee1.js"><link rel="prefetch" href="/assets/js/35.13feed40.js"><link rel="prefetch" href="/assets/js/36.0c34aed6.js"><link rel="prefetch" href="/assets/js/37.9202d6c9.js"><link rel="prefetch" href="/assets/js/38.f8e129a2.js"><link rel="prefetch" href="/assets/js/39.0021dfc1.js"><link rel="prefetch" href="/assets/js/4.b39abf1d.js"><link rel="prefetch" href="/assets/js/40.d374cda1.js"><link rel="prefetch" href="/assets/js/41.eb48efb9.js"><link rel="prefetch" href="/assets/js/42.c2f93674.js"><link rel="prefetch" href="/assets/js/43.e2ce89c2.js"><link rel="prefetch" href="/assets/js/44.aaf30fa0.js"><link rel="prefetch" href="/assets/js/45.655cd797.js"><link rel="prefetch" href="/assets/js/46.757b1616.js"><link rel="prefetch" href="/assets/js/47.dfbd58c8.js"><link rel="prefetch" href="/assets/js/48.ddcab0e9.js"><link rel="prefetch" href="/assets/js/49.47ce1e24.js"><link rel="prefetch" href="/assets/js/5.4518cf99.js"><link rel="prefetch" href="/assets/js/50.2f72f340.js"><link rel="prefetch" href="/assets/js/51.51bf10d2.js"><link rel="prefetch" href="/assets/js/52.915d4928.js"><link rel="prefetch" href="/assets/js/53.050f68ad.js"><link rel="prefetch" href="/assets/js/54.2fca5495.js"><link rel="prefetch" href="/assets/js/55.9779c5a2.js"><link rel="prefetch" href="/assets/js/56.02b0dbbd.js"><link rel="prefetch" href="/assets/js/57.632fdb32.js"><link rel="prefetch" href="/assets/js/58.470f45fc.js"><link rel="prefetch" href="/assets/js/59.ad62ca3e.js"><link rel="prefetch" href="/assets/js/6.1185b8bd.js"><link rel="prefetch" href="/assets/js/60.36c90e5d.js"><link rel="prefetch" href="/assets/js/61.ecfed753.js"><link rel="prefetch" href="/assets/js/62.bd28e9c4.js"><link rel="prefetch" href="/assets/js/63.85dcd7b8.js"><link rel="prefetch" href="/assets/js/64.4d8ebbb4.js"><link rel="prefetch" href="/assets/js/65.ddaa4c0d.js"><link rel="prefetch" href="/assets/js/67.f3c5c614.js"><link rel="prefetch" href="/assets/js/7.2127d0de.js"><link rel="prefetch" href="/assets/js/8.760e0ac9.js"><link rel="prefetch" href="/assets/js/9.01276f18.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0d19fd84.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zh/" class="home-link router-link-active"><!----> <span class="site-name">白 日 淡</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zh/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/zh/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/zh/sources/" class="nav-link">资源收集</a></div><div class="nav-item"><a href="/zh/guoxue/" class="nav-link">国学</a></div><div class="nav-item"><a href="https://www.jianshu.com/u/316beb0573ae" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/zh/unfilter/" class="nav-link router-link-active">未分类</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zh/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/zh/computer/" class="nav-link">计算机</a></div><div class="nav-item"><a href="/zh/sources/" class="nav-link">资源收集</a></div><div class="nav-item"><a href="/zh/guoxue/" class="nav-link">国学</a></div><div class="nav-item"><a href="https://www.jianshu.com/u/316beb0573ae" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/zh/unfilter/" class="nav-link router-link-active">未分类</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>未分类</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/zh/unfilter/" class="sidebar-link">未分类文章</a></li><li><a href="/zh/unfilter/缓存服务探索.html" class="sidebar-link">缓存服务探索</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/unfilter/缓存服务探索.html#更新缓存的四种设计模式-design-pattern" class="sidebar-link">更新缓存的四种设计模式(Design Pattern)</a></li><li class="sidebar-sub-header"><a href="/zh/unfilter/缓存服务探索.html#分布式系统的事务处理" class="sidebar-link">分布式系统的事务处理</a></li></ul></li><li><a href="/zh/unfilter/自动化部署.html" class="active sidebar-link">导语：为什么需要自动化部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/unfilter/自动化部署.html#docker" class="sidebar-link">Docker</a></li><li class="sidebar-sub-header"><a href="/zh/unfilter/自动化部署.html#docker容器" class="sidebar-link">Docker容器</a></li><li class="sidebar-sub-header"><a href="/zh/unfilter/自动化部署.html#docker仓库" class="sidebar-link">Docker仓库</a></li><li class="sidebar-sub-header"><a href="/zh/unfilter/自动化部署.html#dockercompose" class="sidebar-link">DockerCompose</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="导语：为什么需要自动化部署"><a href="#导语：为什么需要自动化部署" aria-hidden="true" class="header-anchor">#</a> 导语：为什么需要自动化部署</h1> <p>随着java系统架构由单体应用向分布式发展，本地单服务器向云端多服务器发展。java环境产生的代码需要向越来越多的服务器进行部署。</p> <p>敏捷开发的流行，让客户或领导急于看到最新的开发进展，需要我们频繁的更新多台服务器的代码。
繁琐且重复的部署命令，不同服务器之间的环境差距，往往容易产生无法预知的问题。</p> <p>在公司又不愿意花钱招运维的情况下，苦逼的java后端程序员急需要使用一种提高部署效率的解决方案。</p> <p>Docker+DockerCompose+Docker-register+GitLab的方式就进入了我们的视野。</p> <h2 id="docker"><a href="#docker" aria-hidden="true" class="header-anchor">#</a> Docker</h2> <h3 id="docker是什么"><a href="#docker是什么" aria-hidden="true" class="header-anchor">#</a> Docker是什么</h3> <p>Docker是一个开源的应用容器引擎。开发者可以将自己的应用打包在可移植的容器中，然后发布到任何Linux上都可以运行。真正的实现了一次构建到处运行。</p> <p>Docker是一种虚拟化技术，由于直接运行在宿主机内核上，且不会虚拟任何硬件。因此资源耗费低，开启速度快，可以达到秒级启动。由于资源耗费低，在一台宿主机上甚至可以启动上千容器。此外，各个容器直接是相互隔离的，安全且高可用，一个容器出问题不会导致整个宿主机出问题。</p> <h3 id="docker架构"><a href="#docker架构" aria-hidden="true" class="header-anchor">#</a> Docker架构</h3> <p>Docker是C/S架构，通过Api管理容器。</p> <p>Docker的容器通过镜像来创建，镜像类似于一套模板。容器可以根据一个镜像创建多个容器，每一个容器之间互相隔离。镜像中的数据会影响容器创建时的数据，容器产生的数据变化不会影响镜像。</p> <h3 id="docker文件系统"><a href="#docker文件系统" aria-hidden="true" class="header-anchor">#</a> Docker文件系统</h3> <p>Docker使用分层文件架构。一个镜像不是一个文件，而是一组文件的集合。在多个镜像之间有相互公用的底层文件时，能大大降低存储空间。因此在创建镜像的时候，每一层尽量只添加需要添加的东西，提供文件的复用率。</p> <h3 id="docker镜像仓库"><a href="#docker镜像仓库" aria-hidden="true" class="header-anchor">#</a> Docker镜像仓库</h3> <p>Docker镜像存在镜像仓库中，Docker官方为我们提供了官方镜像库<a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，我们也可以搭建自己的私有仓库。</p> <h3 id="安装dokcer"><a href="#安装dokcer" aria-hidden="true" class="header-anchor">#</a> 安装Dokcer</h3> <p>Docker分为CE社区版与EE企业版。普通人家只要装Docker CE就足够满足日常需求。</p> <h4 id="centos安装"><a href="#centos安装" aria-hidden="true" class="header-anchor">#</a> CentOS安装</h4> <blockquote><p>⚠️：Docer在CentOS上运行需要系统为64位，且内核版本在3.10以上。</p></blockquote> <p>官方教程可参考<a href="https://docs.docker.com/install/linux/docker-ce/centos/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/install/linux/docker-ce/centos/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>中文版本可参考<a href="http://www.runoob.com/docker/centos-docker-install.html" target="_blank" rel="noopener noreferrer">http://www.runoob.com/docker/centos-docker-install.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="查看系统的内核版本"><a href="#查看系统的内核版本" aria-hidden="true" class="header-anchor">#</a> 查看系统的内核版本</h5> <div class="language- extra-class"><pre class="language-text"><code>[root@ludan /]# uname -r
</code></pre></div><div><img src="http://qiniu.xuchen.link/8fad2a093a88bcdb8fb39b2ac2b89517.png" width="200" height="80" alt="3.10以上内核版本"></div> <h5 id="删除旧版本"><a href="#删除旧版本" aria-hidden="true" class="header-anchor">#</a> 删除旧版本</h5> <div class="language- extra-class"><pre class="language-text"><code>$ sudo yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-selinux \
                  docker-engine-selinux \
                  docker-engine
</code></pre></div><h5 id="安装必要系统工具"><a href="#安装必要系统工具" aria-hidden="true" class="header-anchor">#</a> 安装必要系统工具</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo yum install -y yum-utils device-mapper-persistent-data lvm2
</code></pre></div><h5 id="添加软件源信息"><a href="#添加软件源信息" aria-hidden="true" class="header-anchor">#</a> 添加软件源信息</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</code></pre></div><h5 id="更新-yum-缓存"><a href="#更新-yum-缓存" aria-hidden="true" class="header-anchor">#</a> 更新 yum 缓存</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo yum makecache fast
</code></pre></div><h5 id="安装-docker-ce"><a href="#安装-docker-ce" aria-hidden="true" class="header-anchor">#</a> 安装 Docker-ce</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo yum -y install docker-ce
</code></pre></div><h5 id="启动docker后台进程"><a href="#启动docker后台进程" aria-hidden="true" class="header-anchor">#</a> 启动docker后台进程</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo systemctl start docker
</code></pre></div><h5 id="测试docker，运行hello-word"><a href="#测试docker，运行hello-word" aria-hidden="true" class="header-anchor">#</a> 测试docker，运行hello-word</h5> <div class="language- extra-class"><pre class="language-text"><code>docker run hello-world
</code></pre></div><h4 id="脚本安装docker"><a href="#脚本安装docker" aria-hidden="true" class="header-anchor">#</a> 脚本安装docker</h4> <h5 id="确保-yum-包更新到最新"><a href="#确保-yum-包更新到最新" aria-hidden="true" class="header-anchor">#</a> 确保 yum 包更新到最新</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo yum update
</code></pre></div><h5 id="执行-docker-安装脚本"><a href="#执行-docker-安装脚本" aria-hidden="true" class="header-anchor">#</a> 执行 Docker 安装脚本</h5> <div class="language- extra-class"><pre class="language-text"><code>curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
</code></pre></div><h5 id="启动容器进程"><a href="#启动容器进程" aria-hidden="true" class="header-anchor">#</a> 启动容器进程</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo systemctl start docker
</code></pre></div><h5 id="验证镜像"><a href="#验证镜像" aria-hidden="true" class="header-anchor">#</a> 验证镜像</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo docker run hello-world
</code></pre></div><h4 id="ubuntu安装docker"><a href="#ubuntu安装docker" aria-hidden="true" class="header-anchor">#</a> Ubuntu安装Docker</h4> <h5 id="卸载旧版本"><a href="#卸载旧版本" aria-hidden="true" class="header-anchor">#</a> 卸载旧版本</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo apt-get remove docker docker-engine docker.io containerd runc
</code></pre></div><h5 id="apt安装"><a href="#apt安装" aria-hidden="true" class="header-anchor">#</a> apt安装</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo apt-get update
sudo apt-get -y install apt-transport-https ca-certificates curl software-properties-common
</code></pre></div><h5 id="安装-gpg-证书"><a href="#安装-gpg-证书" aria-hidden="true" class="header-anchor">#</a> 安装 GPG 证书</h5> <div class="language- extra-class"><pre class="language-text"><code>curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
</code></pre></div><h5 id="写入软件信息"><a href="#写入软件信息" aria-hidden="true" class="header-anchor">#</a> 写入软件信息</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo add-apt-repository &quot;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable&quot;
</code></pre></div><h5 id="更新并安装-docker-ce"><a href="#更新并安装-docker-ce" aria-hidden="true" class="header-anchor">#</a> 更新并安装 Docker CE</h5> <div class="language- extra-class"><pre class="language-text"><code>sudo apt-get -y update
sudo apt-get -y install docker-ce
</code></pre></div><h5 id="测试"><a href="#测试" aria-hidden="true" class="header-anchor">#</a> 测试</h5> <div class="language- extra-class"><pre class="language-text"><code>docker run hello-world
</code></pre></div><h4 id="镜像加速"><a href="#镜像加速" aria-hidden="true" class="header-anchor">#</a> 镜像加速</h4> <h5 id="ubuntu-16-04-、debian-8-、centos-7"><a href="#ubuntu-16-04-、debian-8-、centos-7" aria-hidden="true" class="header-anchor">#</a> Ubuntu 16.04+、Debian 8+、CentOS 7</h5> <blockquote><p>⚠️ 针对systemd系统使用如下方法</p></blockquote> <p>在<code>/etc/docker/daemon.json</code>设置仓库地址</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;registry-mirrors&quot;: [
    &quot;https://registry.docker-cn.com&quot;
  ]
}
</code></pre></div><h5 id="检查加速器是否生效"><a href="#检查加速器是否生效" aria-hidden="true" class="header-anchor">#</a> 检查加速器是否生效</h5> <p>在命令行执行<code>docker info</code>
如果在命令回显的消息中出现如下信息,则表示成功</p> <div class="language- extra-class"><pre class="language-text"><code>Registry Mirrors:
 https://registry.docker-cn.com/
</code></pre></div><h4 id="删除docker-ce"><a href="#删除docker-ce" aria-hidden="true" class="header-anchor">#</a> 删除docker-ce</h4> <div class="language- extra-class"><pre class="language-text"><code>sudo yum remove docker-ce
sudo rm -rf /var/lib/docker
</code></pre></div><h3 id="docker镜像"><a href="#docker镜像" aria-hidden="true" class="header-anchor">#</a> Docker镜像</h3> <p>Docker的容器启动需要依赖镜像。在运行容器的时候如果本地没有镜像则自动会去docker镜像仓库中下载。</p> <h4 id="拉取镜像"><a href="#拉取镜像" aria-hidden="true" class="header-anchor">#</a> 拉取镜像</h4> <p>可以通过<code>docker pull</code>命令主动获取镜像。命令格式为</p> <div class="language- extra-class"><pre class="language-text"><code>docker pull [OPTIONS] NAME[:TAG|@DIGEST]
</code></pre></div><p>OPTIONS是选项。</p> <div class="language- extra-class"><pre class="language-text"><code> -a, --all-tags               下载所有标记的镜像

  --disable-content-trust   跳过验证（默认为true）
</code></pre></div><p>NAME是镜像名，一般由<code>域名/IP[:端口]仓库名</code>构成，官方镜像默认只有仓库名
TAG是标签，一般为版本号。</p> <h4 id="展示镜像"><a href="#展示镜像" aria-hidden="true" class="header-anchor">#</a> 展示镜像</h4> <p>可以使用<code>docker image ls</code>命令展示所有镜像。展示的列表：</p> <div class="language- extra-class"><pre class="language-text"><code>$ docker images fedora

REPOSITORY   TAG         IMAGE ID        CREATED      SIZE
fedora       rawhide     ad57ef8d78d7    5 days ago   359.3 MB
fedora       20          105182bb5e8b    5 days ago   372.7 MB
fedora       heisenbug   105182bb5e8b    5 days ago   372.7 MB
fedora       latest      105182bb5e8b    5 days ago   372.7 MB
&lt;none&gt;       &lt;none&gt;      105182bb5e8a    6 days ago   372.7 MB
</code></pre></div><p>列表包含了仓库名（REPOSITORY）、标签（TAG）、镜像唯一id（IMAGE ID）、最近创建日期（CREATED）、大小（SIZE）</p> <h4 id="虚悬镜像"><a href="#虚悬镜像" aria-hidden="true" class="header-anchor">#</a> 虚悬镜像</h4> <p>上列表中仓库名与标签都为none的为虚悬镜像。仓库名与标签对应一个唯一的镜像，但是这个镜像可以更换。当同一个镜像名+标签所指向的镜像更换后，旧的镜像就失去指引，变成虚悬镜像，类似于java中的对象失去了引用。可以通过<code>docker image prune</code>命令删除.</p> <h4 id="删除镜像"><a href="#删除镜像" aria-hidden="true" class="header-anchor">#</a> 删除镜像</h4> <div class="language- extra-class"><pre class="language-text"><code>docker image rm [选项] &lt;镜像1&gt; [&lt;镜像2&gt; ...]
</code></pre></div><p>其中，镜像既可以是镜像名，短id，长id或是摘要</p> <h5 id="强制删除镜像"><a href="#强制删除镜像" aria-hidden="true" class="header-anchor">#</a> 强制删除镜像</h5> <div class="language- extra-class"><pre class="language-text"><code>docker rmi [选项] &lt;镜像1&gt; [&lt;镜像2&gt; ...]
</code></pre></div><h3 id="使用dockerfile定制镜像"><a href="#使用dockerfile定制镜像" aria-hidden="true" class="header-anchor">#</a> 使用Dockerfile定制镜像</h3> <p>（待更新）</p> <h2 id="docker容器"><a href="#docker容器" aria-hidden="true" class="header-anchor">#</a> Docker容器</h2> <h3 id="启动容器"><a href="#启动容器" aria-hidden="true" class="header-anchor">#</a> 启动容器</h3> <h4 id="新建容器并启动"><a href="#新建容器并启动" aria-hidden="true" class="header-anchor">#</a> 新建容器并启动</h4> <div class="language- extra-class"><pre class="language-text"><code> docker run [OPTIONS] IMAGE [COMMAND] [ARG...]
</code></pre></div><p>(OPTIONS太多，不赘述)主要使用的最多的就是直接<code>docker run 镜像名</code></p> <p>常用参数：</p> <div class="language- extra-class"><pre class="language-text"><code>-i Keep STDIN open even if not attached（在没有连接的情况下持续打开标准输入）
-t Allocate a pseudo-TTY（分配一个伪终端）
</code></pre></div><h4 id="启动已中止容器"><a href="#启动已中止容器" aria-hidden="true" class="header-anchor">#</a> 启动已中止容器</h4> <div class="language- extra-class"><pre class="language-text"><code>docker container start [OPTIONS] 容器名1 [容器2...]
</code></pre></div><h4 id="守护态运行"><a href="#守护态运行" aria-hidden="true" class="header-anchor">#</a> 守护态运行</h4> <p>在启动的时候，加上参数 <code>-d</code>即可作为守护态运行。运行后，容器产生的相关输出结果不会显示在控制台上，而是显示一个容器id。</p> <p>可以通过<code>docker container logs 容器名或id</code>查看容器相关日志</p> <h3 id="终止容器"><a href="#终止容器" aria-hidden="true" class="header-anchor">#</a> 终止容器</h3> <div class="language- extra-class"><pre class="language-text"><code>docker container stop [OPTIONS] CONTAINER [CONTAINER...]
</code></pre></div><p>参数：</p> <div class="language- extra-class"><pre class="language-text"><code>-t 关闭前等待时间，默认10s
</code></pre></div><h3 id="进入容器"><a href="#进入容器" aria-hidden="true" class="header-anchor">#</a> 进入容器</h3> <p>进入容器有两个命令：<code>attach</code>和<code>exec</code>.</p> <p><code>attach</code>不推荐使用，因为在退出容器的时候会停止容器。</p> <p><code>exec</code>常搭配-it使用，以交互的方式进入容器。</p> <p>常见用法</p> <p><code>docker exec -it 容器名 /bin/bash</code>,使用后，就如普通的终端一样。</p> <h2 id="docker仓库"><a href="#docker仓库" aria-hidden="true" class="header-anchor">#</a> Docker仓库</h2> <p>Docker仓库是存放docker镜像的中心，支持官方仓库与自建私有仓库。</p> <h3 id="docker-hub"><a href="#docker-hub" aria-hidden="true" class="header-anchor">#</a> <a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <p>可以通过<code>docker search</code>命令来查找官方仓库中的镜像，并利用<code>docker pull</code>命令来将它下载到本地。</p> <h4 id="docker-registry"><a href="#docker-registry" aria-hidden="true" class="header-anchor">#</a> <a href="https://docs.docker.com/registry/" target="_blank" rel="noopener noreferrer">docker-registry<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h4> <p>官方提供用于构建私有仓库的工具。</p> <p>官方文档：https://docs.docker.com/registry/</p> <h4 id="下载registry"><a href="#下载registry" aria-hidden="true" class="header-anchor">#</a> 下载registry</h4> <p>获取官方registry镜像并运行</p> <div class="language- extra-class"><pre class="language-text"><code>docker run -d -p 5000:5000 --restart=always --name registry registry
</code></pre></div><h4 id="在配置文件中添加私有仓库地址"><a href="#在配置文件中添加私有仓库地址" aria-hidden="true" class="header-anchor">#</a> 在配置文件中添加私有仓库地址</h4> <p>对于<code>systemd</code>系统，打开之前设置的<code>/etc/docker/daemon.json</code>,添加一条镜像地址。</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;registry-mirrors&quot;: [
    &quot;https://registry.docker-cn.com&quot;
  ],
  &quot;insecure-registries&quot;: [
    &quot;127.0.0.0:5000&quot;
  ]
}
</code></pre></div><h4 id="使用流程"><a href="#使用流程" aria-hidden="true" class="header-anchor">#</a> 使用流程</h4> <h5 id="从官方下载镜像"><a href="#从官方下载镜像" aria-hidden="true" class="header-anchor">#</a> 从官方下载镜像</h5> <p><code>docker pull ubuntu</code></p> <h5 id="为私有镜像标记特有的名称"><a href="#为私有镜像标记特有的名称" aria-hidden="true" class="header-anchor">#</a> 为私有镜像标记特有的名称</h5> <p><code>docker image tag ubuntu localhost:5000/myfirstimage</code></p> <h5 id="上传到私有镜像"><a href="#上传到私有镜像" aria-hidden="true" class="header-anchor">#</a> 上传到私有镜像</h5> <p><code>docker push localhost:5000/myfirstimage</code></p> <h5 id="从私有仓库下载刚上传的镜像"><a href="#从私有仓库下载刚上传的镜像" aria-hidden="true" class="header-anchor">#</a> 从私有仓库下载刚上传的镜像</h5> <p><code>docker pull localhost:5000/myfirstimage</code></p> <h2 id="dockercompose"><a href="#dockercompose" aria-hidden="true" class="header-anchor">#</a> DockerCompose</h2> <h3 id="dockercompose是什么"><a href="#dockercompose是什么" aria-hidden="true" class="header-anchor">#</a> DockerCompose是什么</h3> <p>Docker很方便的为我们进行了应用的部署，但是当大量的容器需要进行管理时，重复的Docker指令也令我们头疼。</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.07421936.js" defer></script><script src="/assets/js/66.b275255b.js" defer></script>
  </body>
</html>
